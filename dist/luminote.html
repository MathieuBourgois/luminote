<!doctype html><html lang="en"><head><meta charset="UTF-8"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/><title>Luminote</title></head><body><div id="viewport"></div><div id="strip"></div><div id="pianoKeyboard" class="pianoKeyboard -disabled"></div><script>(()=>{"use strict";var t={991:(t,e,s)=>{s.d(e,{Z:()=>a});var i=s(537),n=s.n(i),o=s(645),r=s.n(o)()(n());r.push([t.id,"*,*::before,*::after{box-sizing:border-box}body{font-family:sans-serif;font-size:1vw;background:#000;color:#fff}body{position:relative;margin:0;height:100vh;overflow:hidden;display:flex;flex-direction:column}#viewport{flex-grow:1}#strip{height:2vh;position:relative}#pianoKeyboard{flex-shrink:0}","",{version:3,sources:["webpack://./src/app.scss"],names:[],mappings:"AAAA,qBACE,qBAAA,CAGF,KACE,sBAAA,CACA,aAAA,CACA,eAAA,CACA,UAAA,CAOF,KACE,iBAAA,CACA,QAAA,CACA,YAAA,CACA,eAAA,CACA,YAAA,CACA,qBAAA,CAIF,UACE,WAAA,CAGF,OACE,UAAA,CACA,iBAAA,CAGF,eACE,aAAA",sourcesContent:["*, *::before, *::after {\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: sans-serif;\n  font-size:   1vw;\n  background:  #000;\n  color:       #fff;\n}\n\n\n/*\n * LAYOUT\n */\nbody {\n  position:       relative;\n  margin:         0;\n  height:         100vh;\n  overflow:       hidden;\n  display:        flex;\n  flex-direction: column;\n}\n\n\n#viewport {\n  flex-grow: 1;\n}\n\n#strip {\n  height: 2vh;\n  position: relative;\n}\n\n#pianoKeyboard {\n  flex-shrink: 0;\n}\n"],sourceRoot:""}]);const a=r},251:(t,e,s)=>{s.d(e,{Z:()=>a});var i=s(537),n=s.n(i),o=s(645),r=s.n(o)()(n());r.push([t.id,".pianoKeyboard{position:relative;display:flex;transition:filter 1s}.pianoKeyboard.-disabled{filter:brightness(0.5)}.pianoKeyboard_blackKeys{position:absolute;inset:0;bottom:33%;display:flex}.pianoKeyboard_blackKeys>*{flex-grow:1}.pianoKeyboard_key{flex-grow:1;transition:background-color 150ms}.pianoKeyboard_key.-white{aspect-ratio:1/6;background:#fff}.pianoKeyboard_key.-white.-pedal{background:#a4d3ee}.pianoKeyboard_key.-white.-on{background:#e7b966}.pianoKeyboard_key.-black{border-radius:0 0 .3vw .3vw;background:#2b2b2b}.pianoKeyboard_key.-black.-pedal{background:#3e89bb}.pianoKeyboard_key.-black.-on{background:#bb893e}","",{version:3,sources:["webpack://./src/components/PianoKeyboard/PianoKeyboard.scss"],names:[],mappings:"AAAA,eACE,iBAAA,CACA,YAAA,CACA,oBAAA,CAEA,yBACE,sBAAA,CAGF,yBACE,iBAAA,CACA,OAAA,CACA,UAAA,CACA,YAAA,CAEA,2BACE,WAAA,CAIJ,mBACE,WAAA,CACA,iCAAA,CAEA,0BACE,gBAAA,CACA,eAAA,CACA,iCAAA,kBAAA,CACA,8BAAA,kBAAA,CAGF,0BACE,2BAAA,CACA,kBAAA,CACA,iCAAA,kBAAA,CACA,8BAAA,kBAAA",sourcesContent:[".pianoKeyboard {\n  position:   relative;\n  display:    flex;\n  transition: filter 1s;\n\n  &.-disabled {\n    filter: brightness(0.5);\n  }\n\n  &_blackKeys {\n    position: absolute;\n    inset:    0;\n    bottom:   33%;\n    display:  flex;\n\n    > * {\n      flex-grow: 1;\n    }\n  }\n\n  &_key {\n    flex-grow:  1;\n    transition: background-color 150ms;\n\n    &.-white {\n      aspect-ratio: 1/6;\n      background:   #fff;\n      &.-pedal { background: rgb(164, 211, 238); }\n      &.-on    { background: rgb(231 185 102); }\n    }\n\n    &.-black {\n      border-radius: 0 0 .3vw .3vw;\n      background:    #2b2b2b;\n      &.-pedal { background: rgb(62, 137, 187); }\n      &.-on    { background: rgb(187 137 62); }\n    }\n  }\n}\n"],sourceRoot:""}]);const a=r},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var s="",i=void 0!==e[5];return e[4]&&(s+="@supports (".concat(e[4],") {")),e[2]&&(s+="@media ".concat(e[2]," {")),i&&(s+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),s+=t(e),i&&(s+="}"),e[2]&&(s+="}"),e[4]&&(s+="}"),s})).join("")},e.i=function(t,s,i,n,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(r[c]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&r[h[0]]||(void 0!==o&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=o),s&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=s):h[2]=s),n&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=n):h[4]="".concat(n)),e.push(h))}},e}},537:t=>{t.exports=function(t){var e=t[1],s=t[3];if(!s)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(n," */");return[e].concat([o]).join("\n")}return[e].join("\n")}},379:t=>{var e=[];function s(t){for(var s=-1,i=0;i<e.length;i++)if(e[i].identifier===t){s=i;break}return s}function i(t,i){for(var o={},r=[],a=0;a<t.length;a++){var c=t[a],l=i.base?c[0]+i.base:c[0],h=o[l]||0,d="".concat(l," ").concat(h);o[l]=h+1;var p=s(d),A={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)e[p].references++,e[p].updater(A);else{var u=n(A,i);i.byIndex=a,e.splice(a,0,{identifier:d,updater:u,references:1})}r.push(d)}return r}function n(t,e){var s=e.domAPI(e);return s.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;s.update(t=e)}else s.remove()}}t.exports=function(t,n){var o=i(t=t||[],n=n||{});return function(t){t=t||[];for(var r=0;r<o.length;r++){var a=s(o[r]);e[a].references--}for(var c=i(t,n),l=0;l<o.length;l++){var h=s(o[l]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}o=c}}},569:t=>{var e={};t.exports=function(t,s){var i=function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(t){s=null}e[t]=s}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,s)=>{t.exports=function(t){var e=s.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(s){!function(t,e,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,n&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var o=s.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,s)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,s),o.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.nc=void 0,(()=>{var t=s(379),e=s.n(t),i=s(795),n=s.n(i),o=s(569),r=s.n(o),a=s(565),c=s.n(a),l=s(216),h=s.n(l),d=s(589),p=s.n(d),A=s(991),u={};u.styleTagTransform=p(),u.setAttributes=c(),u.insert=r().bind(null,"head"),u.domAPI=n(),u.insertStyleElement=h(),e()(A.Z,u),A.Z&&A.Z.locals&&A.Z.locals;class f{static getName(t){return f.MIDI_TO_NAME[t%12]}static getMidiNote(t){let[,e,s]=/^([a-gA-G]#?)(\d)$/.exec(t)||[];return f.NAME_TO_MIDI[e.toUpperCase()]+12*Number(s)}static getOctave(t){return Math.floor(t/12)}static getFrequency(t){return 440*Math.pow(2,(t-69)/12)}static getPreviousMidiNoteByName(t,e){let s=e;do{s--}while(f.getName(s)!==t);return s}static getNextMidiNoteByName(t,e){let s=e;do{s++}while(f.getName(s)!==t);return s}}f.MIDI_TO_NAME=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],f.NAME_TO_MIDI={C:0,"C#":1,D:2,"D#":3,E:4,F:5,"F#":6,G:7,"G#":8,A:9,"A#":10,B:11};var g=s(251),y={};y.styleTagTransform=p(),y.setAttributes=c(),y.insert=r().bind(null,"head"),y.domAPI=n(),y.insertStyleElement=h(),e()(g.Z,y),g.Z&&g.Z.locals&&g.Z.locals;class b{static isBlackKey(t){return-1!==f.getName(t).indexOf("#")}static isWhiteKey(t){return!b.isBlackKey(t)}constructor(t,e="A1",s="C9"){this.pedalThreshold=43,this.pedalLevel=0,this.keys={},this.element=t,this.noteStart="string"==typeof e?f.getMidiNote(e):e,this.noteEnd="string"==typeof s?f.getMidiNote(s):s,this.init()}get totalKeys(){return this.noteEnd-this.noteStart+1}init(){const t=document.createElement("div");t.classList.add("pianoKeyboard_blackKeys"),t.style.left=this.leftMargin+"%",t.style.right=this.rightMargin+"%",this.element.appendChild(t);for(let e=this.noteStart;e<=this.noteEnd;e++){const s=document.createElement("div");s.classList.add("pianoKeyboard_key"),this.keys[e]=s,b.isWhiteKey(e)?(s.classList.add("-white"),this.element.appendChild(s),t.appendChild(document.createElement("div"))):(s.classList.add("-black"),t.appendChild(s))}}disable(){this.element.classList.add("-disabled")}enable(){this.element.classList.remove("-disabled")}get leftMargin(){const t=f.getPreviousMidiNoteByName("C",this.noteStart);return(this.noteStart-t)*this.blackKeyWidthPercent-this.getWhiteKeyCount(t,this.noteStart-1)*this.whiteKeyWidthPercent}get rightMargin(){const t=f.getNextMidiNoteByName("B",this.noteEnd);return(t-this.noteEnd)*this.blackKeyWidthPercent-this.getWhiteKeyCount(this.noteEnd+1,t)*this.whiteKeyWidthPercent}get whiteKeyWidthPercent(){return 100/this.getWhiteKeyCount()}get blackKeyWidthPercent(){return 7*this.whiteKeyWidthPercent/12}pressKey(t){this.keys[t]&&(this.keys[t].classList.add("-on"),this.isPedalDown()&&this.keys[t].classList.add("-pedal"))}releaseKey(t){this.keys[t]&&this.keys[t].classList.remove("-on")}setPedal(t){this.pedalLevel=t,this.isPedalDown()?this.element.querySelectorAll(".-on").forEach((t=>{t.classList.add("-pedal")})):this.element.querySelectorAll(".-pedal").forEach((t=>{t.classList.remove("-pedal")}))}isPedalDown(){return this.pedalLevel>this.pedalThreshold}getWhiteKeyCount(t=this.noteStart,e=this.noteEnd){let s=0;for(let i=t;i<=e;i++)b.isWhiteKey(i)&&s++;return s}getBlackKeyCount(t=this.noteStart,e=this.noteEnd){let s=0;for(let i=t;i<=e;i++)b.isBlackKey(i)&&s++;return s}getKeyCount(){return this.noteEnd-this.noteStart+1}}class v{constructor(t,e=4,s=0,i=0,n=0,o=0){this.isDirty=!1,this._stripLength=t,this._colorPerPixel=e,this._floatRawData=new Float64Array(this._stripLength*this._colorPerPixel),this._intRawData=new Uint8Array(this._stripLength*this._colorPerPixel),this.fill(s,i,n,o)}get length(){return this._stripLength}getColorPerPixel(){return this._colorPerPixel}set(t,e,s,i,n=0){const o=this._floatRawData[t*this._colorPerPixel],r=this._floatRawData[t*this._colorPerPixel+1],a=this._floatRawData[t*this._colorPerPixel+2];let c=0;4===this._colorPerPixel&&(c=this._floatRawData[t*this._colorPerPixel+3]),Math.round(1e4*e)===Math.round(1e4*o)&&Math.round(1e4*s)===Math.round(1e4*r)&&Math.round(1e4*i)===Math.round(1e4*a)&&Math.round(1e4*n)===Math.round(1e4*c)||(this._floatRawData[t*this._colorPerPixel]=e,this._floatRawData[t*this._colorPerPixel+1]=s,this._floatRawData[t*this._colorPerPixel+2]=i,this._intRawData[t*this._colorPerPixel]=Math.floor(256*e),this._intRawData[t*this._colorPerPixel+1]=Math.floor(256*s),this._intRawData[t*this._colorPerPixel+2]=Math.floor(256*i),4===this._colorPerPixel&&(this._floatRawData[t*this._colorPerPixel+3]=n,this._intRawData[t*this._colorPerPixel+3]=Math.floor(256*n)),this.isDirty=!0)}get(t){const e={r:this._floatRawData[t*this._colorPerPixel],g:this._floatRawData[t*this._colorPerPixel+1],b:this._floatRawData[t*this._colorPerPixel+2]};return 4===this._colorPerPixel&&(e.w=this._floatRawData[t*this._colorPerPixel+3]),e}getInt(t){const e={r:this._intRawData[t*this._colorPerPixel],g:this._intRawData[t*this._colorPerPixel+1],b:this._intRawData[t*this._colorPerPixel+2]};return 4===this._colorPerPixel&&(e.w=this._intRawData[t*this._colorPerPixel+3]),e}fill(t,e,s,i=0){for(let e=0;e<this._stripLength;e++)this.set(e,t,s,s,i)}getIntRawData(){return this._intRawData}forEach(t){for(let e=0,s=this.length;e<s;e++)t(e)}copyTo(t,e=0){for(let s=e;s<this.length;s++)if(s>=0&&s<t.length){const i=s-e,n=this.get(s);t.set(i,n.r,n.g,n.b,n.w)}}}class m extends EventTarget{constructor(){super(...arguments),this._onMidiSuccess=t=>{console.log("MidiAccess -> API: OK"),t.addEventListener("statechange",(e=>{const s=e.port;if("input"===s.type)switch(s.state){case"connected":switch(s.connection){case"closed":this._connectInput(t);break;case"open":console.log("MidiAccess -> Device: Input connected"),this.dispatchEvent(new Event("input_connected"))}break;case"disconnected":console.log("MidiAccess -> Device: Input disconnected"),this.dispatchEvent(new Event("input_disconnected"))}})),this._connectInput(t)},this._onMidiFailure=t=>{console.log("MidiAccess: No access to MIDI devices or your browser doesn't support WebMIDI API. Please use WebMIDIAPIShim "+t)},this._onMidiMessage=t=>{let e=t.data,s=240&e[0],i=e[1],n=e[2];switch(s){case 144:n>0?this.dispatchEvent(new CustomEvent("note_on",{detail:{note:i,velocity:n}})):this.dispatchEvent(new CustomEvent("note_off",{detail:{note:i}}));break;case 128:this.dispatchEvent(new CustomEvent("note_off",{detail:{note:i}}));break;case 176:switch(i){case 64:this.dispatchEvent(new CustomEvent("sustain",{detail:{level:n}}));break;case 67:this.dispatchEvent(new CustomEvent("softPedal",{detail:{level:n}}))}}}}requestMidiAccess(){navigator.requestMIDIAccess?navigator.requestMIDIAccess({sysex:!1}).then(this._onMidiSuccess).catch(this._onMidiFailure):alert("No MIDI support in your browser. Please try with Google Chrome.")}_connectInput(t){const e=t.inputs.values();for(let t=e.next();t&&!t.done;t=e.next())t.value.onmidimessage=this._onMidiMessage}}const C={remoteStrip:{hostname:"192.168.1.43",startNote:f.getMidiNote("A1")},pianoKeyboard:{noteRange:{start:f.getMidiNote("A1"),end:f.getMidiNote("C9")}}},w=new b(document.getElementById("pianoKeyboard"),C.pianoKeyboard.noteRange.start,C.pianoKeyboard.noteRange.end),_=new v(C.pianoKeyboard.noteRange.end-C.pianoKeyboard.noteRange.start+1);let E,P;new class{constructor(t,e){this.modeEcoDelay=60,this._lastSyncTime=0,this._isEcoMode=!1,this._isClosed=!0,this.hostname=t,this.onConnected=e,this.connect()}connect(){this.socket=new WebSocket(`ws://${this.hostname}`),this.socket.onopen=()=>{console.log("RemoteStrip -> Websocket: Connection established"),console.time("RemoteStrip -> Websocket: connected"),this._isClosed=!1},this.socket.onmessage=t=>{console.log("RemoteStrip -> Websocket: Data reception: "+t.data);try{const e=JSON.parse(t.data);e.stripLength&&e.colorPerPixel&&e.fpsMax&&(this.fpsMax=e.fpsMax,this.strip=new v(e.stripLength,e.colorPerPixel),"function"==typeof this.onConnected&&this.onConnected(this.strip,(()=>this.sync())),this._modeEcoTimeInterval=setInterval((()=>this._isEcoMode=!0),1e3*this.modeEcoDelay))}catch(t){console.log(t)}},this.socket.onclose=()=>{console.log("RemoteStrip -> Websocket: Connection closed"),console.timeEnd("RemoteStrip -> Websocket: connected"),clearInterval(this._modeEcoTimeInterval),this._isClosed=!0,this.connect()},this.socket.onerror=t=>{console.error("RemoteStrip -> Websocket: Socket encountered error: ",t.message," Closing socket"),this.socket.close()}}sync(){const t=performance.now();t>this._lastSyncTime+1e3/this.fpsMax&&!this._isClosed&&this.socket&&this.strip&&(!this._isEcoMode||this._isEcoMode&&this.strip.isDirty)&&(this._lastSyncTime=t,this._isEcoMode=!1,this.strip.isDirty=!1,this.socket.send(this.strip.getIntRawData()))}}(C.remoteStrip.hostname,((t,e)=>{E=t,P=e}));const x=document.getElementById("strip"),k=new class{constructor(t,e,s=1){this.parentElement=t,this.strip=e,this.factor=s,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.bottom="0",this.canvas.style.left="0",this.canvas.style.right="0",this.context=this.canvas.getContext("2d"),this.parentElement.appendChild(this.canvas),this._resize(),window.addEventListener("resize",(()=>{this._resize()}))}_resize(){this.canvas.height=this.parentElement.clientHeight,this.canvas.width=this.parentElement.clientWidth}render(){const t=this.canvas.width/this.strip.length,e=this.canvas.height;this.strip.forEach((s=>{const i=this.strip.get(s),n=Math.min(255,255*i.r*this.factor+255*i.w*this.factor*.5),o=Math.min(255,255*i.g*this.factor+255*i.w*this.factor*.5),r=Math.min(255,255*i.b*this.factor+255*i.w*this.factor*.35);this.context.fillStyle=`rgb(${n}, ${o}, ${r})`,this.context.fillRect(t*s,this.canvas.height-e,t,e)}))}}(x,_,8);x.style.marginLeft=w.leftMargin+"%",x.style.marginRight=w.rightMargin+"%",requestAnimationFrame((()=>k._resize()));const M=[];_.forEach((t=>{M[t]={pressed:!1,pedal:!1,velocity:0}}));const K=new m;K.addEventListener("input_connected",(()=>{w.enable()})),K.addEventListener("input_disconnected",(()=>{w.disable()})),K.addEventListener("note_on",(t=>{w.pressKey(t.detail.note),M[t.detail.note-C.pianoKeyboard.noteRange.start].pressed=!0,M[t.detail.note-C.pianoKeyboard.noteRange.start].pedal=w.isPedalDown(),M[t.detail.note-C.pianoKeyboard.noteRange.start].velocity=t.detail.velocity/128})),K.addEventListener("note_off",(t=>{w.releaseKey(t.detail.note),M[t.detail.note-C.pianoKeyboard.noteRange.start].pressed=!1})),K.addEventListener("sustain",(t=>{w.setPedal(t.detail.level),w.isPedalDown()?M.forEach((t=>t.pedal=!(!t.pressed&&!t.pedal))):M.forEach((t=>t.pedal=!1))})),K.requestMidiAccess();const D=(new class{constructor(t,e){this.strip=t,this.notes=e}update(){this.strip.forEach((t=>{if(this.notes[t].pressed)this.strip.set(t,0,0,0,this.notes[t].velocity),this.notes[t].velocity*=.99;else if(this.notes[t].pedal)this.strip.set(t,.15*this.notes[t].velocity,.3*this.notes[t].velocity,.3*this.notes[t].velocity,0),this.notes[t].velocity*=.99;else{const e=this.strip.get(t);this.strip.set(t,.8*e.r,.8*e.g,.8*e.b,.8*e.w)}}))}}(_,M),new class{constructor(t,e){this.strip=t,this.notes=e,this.stripBuffer=new v(t.length,t.getColorPerPixel())}update(){this.stripBuffer.forEach((t=>{const e=this.strip.get(t);let s,i;t>0&&(s=this.strip.get(t-1)),t<this.stripBuffer.length-1&&(i=this.strip.get(t+1));const n={r:((s?s.r:0)+e.r+(i?i.r:0))/(1+(s?1:0)+(i?1:0)),g:((s?s.g:0)+e.g+(i?i.g:0))/(1+(s?1:0)+(i?1:0)),b:((s?s.b:0)+e.b+(i?i.b:0))/(1+(s?1:0)+(i?1:0)),w:((s?s.w:0)+e.w+(i?i.w:0))/(1+(s?1:0)+(i?1:0))};this.stripBuffer.set(t,n.r,n.g,n.b,n.w)})),this.strip.forEach((t=>{const e=this.stripBuffer.get(t);this.notes[t].pressed?(this.strip.set(t,e.r,e.g,e.b,e.w+.2*this.notes[t].velocity),this.notes[t].velocity*=.99):this.notes[t].pedal?(this.strip.set(t,e.r+.15*this.notes[t].velocity*.2,e.g+.3*this.notes[t].velocity*.2,e.b+.3*this.notes[t].velocity*.2,.95*e.w),this.notes[t].velocity*=.99):this.strip.set(t,.95*e.r,.95*e.g,.95*e.b,.95*e.w)}))}}(_,M));new class{constructor(t,e){this.strip=t,this.notes=e}update(){this.strip.forEach((t=>{this.notes[t].pressed||this.notes[t].pedal||this.strip.set(t,0,0,0,0)})),this.strip.forEach((t=>{(this.notes[t].pressed||this.notes[t].pedal)&&this.strip.forEach((e=>{t!==e&&t%12==e%12&&this.strip.set(e,2,4,4,0)}))})),this.strip.forEach((t=>{this.notes[t].pressed?this.strip.set(t,0,0,0,60):this.notes[t].pedal&&this.strip.set(t,20,40,40,0)}))}}(_,M),function t(){if(D.update(),E&&P){const t=C.remoteStrip.startNote-C.pianoKeyboard.noteRange.start;_.copyTo(E,t),P()}k.render(),setTimeout(t,20)}()})()})();
//# sourceMappingURL=app.js.map</script></body></html>